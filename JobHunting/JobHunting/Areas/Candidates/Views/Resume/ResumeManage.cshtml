@section Styles
{
    <style>
        
    </style>
}

<div class="container-fluid py-2" id="ResumeApp">
    <div class="letters row">
        @* 履歷新增 *@
        <div class="col-md-3 mb-4 " >
            <a href="#" data-bs-toggle="modal" style="text-decoration:none;" data-bs-target="#insertmodelID">
                <div class="card rounded-5 " style="width: 15rem; height: 15rem;">
                    <div class="card-body ">
                        <h2 class="text-center mt-5 " >
                            新增<br />履歷
                        </h2>
                    </div>
                </div>
            </a>

            
        </div>

        @* 履歷職缺card *@
        <div class="col-md-3 mb-4" v-for="ResumeD in Resume.slice(pageStart,pageEnd)">
            <div class="card rounded-5" style="width: 15rem; height: 15rem;">
                <div class="card-body" style="">
                    <div class="" style="text-align:right">
                        @* 刪除履歷 *@
                        <button type="button" class="btn-close text-right" aria-label="Close" v-on:click="deleteResume(ResumeD)"></button>
                    </div>
                    <div class="">
                        <p class="fs-6 text-center fs-4">履歷名稱</p>
                            <hr>
                        <p  class="card-title pb-3 text-center fs-3">{{ResumeD.title.slice(0,13)}}</p>
                    </div>
                    @* 履歷內容按鈕 *@
                        <div class="text-center">
                            <button type="button" data-bs-toggle="modal"
                                :data-bs-target="'#'+mergeID(ResumeD)" class="btn btn-primary">
                                詳細
                            </button>
                        </div>
                </div>
            </div>
        </div>

        


        @*履歷新增內容*@

            <div class="modal fade" 
                 id="insertmodelID"
                 tabindex="-1"
                 data-bs-backdrop="static"
                 data-bs-keyboard="false"
                 role="dialog"
                 aria-labelledby="modalTitleId"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl"
                     role="document">
                    <div class="modal-content">
                        <div class="card modal-body bg-warning">
                                <div class="card-body container-fluid">
                                <div class="modal-header" style="background-color: #f7d179;">
                                    <h5 class="modal-titl text-center" id="modal" style="width:95% ;">
                                    <input type="text" class="text-center " name="name" value="" placeholder="請輸入履歷名稱" v-model.lazy="ResumeName" />
                                    </h5>

                                    <button type="button"
                                            class="btn-close"
                                            data-bs-dismiss="modal"
                                            aria-label="Close"
                                        style="width:5% ;" v-on:click="Createcancel">
                                    </button>
                                </div>

                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="card mb-3">
                                            <div class="card-body">
                                            
                                            <h5 class="card-title" style="text-align:center">個人資料</h5>
                                            <div>
                                                <a href="#" class="mb-3" v-on:click.prevent="">
                                                    <div>
                                                        @* <label for="imageA" class="rounded float-end form-label">上傳圖片</label> *@
                                                        <img class="rounded float-end mx-4 img-fluid" :src="noimagepreview" style="width:100px;height:100px" title="待上傳" />
                                                    </div>
                                                    
                                                 </a>

                                                <input id="HeadshotinsertFile" ref="fileInput" class="" style="" type="file" name="name" value="" accept="image/*" v-on:change="CreatepreviewImage" />
                                                
                                                
                                            </div>
                                                <p class="card-text">
                                                    <div class="col">
                                                        <label class="mb-2" size="10">名字
                                                        <input type="text" required v-model="" disabled placeholder="根據求職者會員資料帶入">
                                                            </label>
                                                    </div>
                                                    <div>
                                                        <label for="" class="mb-2">性別 : </label>
                                                        <input type="radio" name="name" value="" disabled/><label>男</label>
                                                        <input type="radio" name="name" value="" disabled/><label>女</label>
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">生日</label>
                                                    <input type="date"  disabled placeholder="根據求職者會員資料帶入">
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">電話 :</label>
                                                    <input class="mx-1" type="tel"  disabled placeholder="根據求職者會員資料帶入">
                                                    <label class="mx-1 mb-2" for="" >學歷 :</label>
                                                    <input class="mx-1" type="text"  disabled placeholder="根據求職者會員資料帶入">
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">郵件 :</label>
                                                    <input type="email" class="form-control " disabled placeholder="根據求職者會員資料帶入" >
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">就業狀態 :</label>
                                                        <input type="text" class="form-control" disabled placeholder="根據求職者會員資料帶入">
                                                    </div>
                                                    <div>
                                                        <p class="card-text">
                                                        自我介紹：
                                                            <textarea name="" id="" class="form-control overflow-auto" rows="6" v-model.lazy="ResumeIntro"></textarea>
                                                        </p>
                                                    </div>
                                                </p>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="card mb-3">
                                            <div class="card-body">
                                                <h5 class="card-title" style="text-align:center">工作經驗</h5>
                                                <p class="card-text">
                                                <textarea name="" id="" class="form-control overflow-auto" rows="12" v-model.lazy="WorkExperience"></textarea>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="card mb-3">
                                            <div class="card-body">
                                                <h5 class="card-title" style="text-align:center">求職條件</h5>
                                                <p class="card-text">
                                                    <div class="col">
                                                    <label class="mb-2">希望上班時段: <input type="text" v-model=""></label>
                                                    </div>

                                                        <div class="mb-3">
                                                                <p>
                                                                    <label>
                                                                        <button class="btn btn-outline-primary " type="button" data-bs-toggle="collapse" data-bs-target="#TitleClassCollapse" aria-expanded="false" aria-controls="TitleClassCollapse">職缺類型</button>
                                                                        check: {{TitleClassCheckedOpening}}<label><span class="badge bg-primary" v-for="item in TitleClassCheckedOpening"></span></label>
                                                                    </label>
                                                                </p>
                                                                <div class="collapse" id="TitleClassCollapse">
                                                                    <div class="card card-body">
                                                                        <template v-for="item in titleCategory">
                                                                            <button class="astext overcard" type="button" data-bs-toggle="collapse" v-bind:data-bs-target="Returnhashtag(ReturnCategoryNameId(item))" aria-expanded="false" v-bind:aria-controls="ReturnCategoryNameId(item)">
                                                                                {{item.titleCategoryName}}
                                                                                <span class="badge bg-warning" v-if="selectedFilterTitleCategory(item.titleCategoryId,TitleClassChecked) > 0">{{selectedFilterTitleCategory(item.titleCategoryId,TitleClassChecked)}}</span>
                                                                            </button>
                                                                            <div class="collapse" v-bind:id="ReturnCategoryNameId(item)">
                                                                                <div class="row">
                                                                                    <div class="px-2" v-for="TitleClass in filterTitleCategory(item.titleCategoryId)">
                                                                                        <input type="checkbox" v-bind:id="ReturnNameId(TitleClass)" v-bind:value="TitleClass.titleClassId" v-model="TitleClassChecked" />
                                                                                        <label v-bind:for="ReturnNameId(TitleClass)">{{TitleClass.titleClassName}}</label>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <hr />
                                                                        </template>
                                                                        <button class="astext overcard" type="button" data-bs-toggle="collapse" data-bs-target="#otherClass" aria-expanded="false" aria-controls="otherClass">
                                                                            其他
                                                                            <span class="badge bg-warning" v-if="selectedFilterTitleCategory(0,TitleClassChecked) > 0">{{selectedFilterTitleCategory(0,TitleClassChecked)}}</span>
                                                                        </button>
                                                                        <div class="collapse" id="otherClass">
                                                                            <div class="row">
                                                                                <div class="col-2" v-for="TitleClass in filterTitleCategory(0)">
                                                                                    <input type="checkbox" v-bind:id="ReturnNameId(TitleClass)" v-bind:value="TitleClass.titleClassId" v-model="TitleClassChecked" />
                                                                                    <label v-bind:for="ReturnNameId(TitleClass)">{{TitleClass.titleClassName}}</label>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div>
                                            

                                                    <div class="col">
                                                    <label class="mb-2">希望上班地點: <input type="text" v-model.lazy="hopeaddress"></label>
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">證照
                                                        <input id="CertificationInsertFile" type="file" accept="image/*" multiple />
                                                        </label>
                                                    </div>

                                                            <p>
                                                                <label>
                                                                    <button class="btn btn-outline-primary " type="button" data-bs-toggle="collapse" data-bs-target="#TagsCollapse" aria-expanded="false" aria-controls="TagsCollapse">能力標籤</button>
                                                                    check: {{TagCheckedOpening}}<label><span class="badge bg-primary" v-for="item in TagCheckedOpening"></span></label>
                                                                </label>
                                                            </p>
                                                            <div class="collapse" id="TagsCollapse">
                                                                <div class="card card-body">
                                                                    <template v-for="item in TagClasses">
                                                                        <button class="astext overcard" type="button" data-bs-toggle="collapse" v-bind:data-bs-target="Returnhashtag(ReturnClassNameId(item))" aria-expanded="false" v-bind:aria-controls="ReturnClassNameId(item)">
                                                                            {{item.tagClassName}}
                                                                            <span class="badge bg-warning" v-if="selectedFilterTagClass(item.tagClassId,TagChecked) > 0">{{selectedFilterTagClass(item.tagClassId,TagChecked)}}</span>
                                                                        </button>
                                                                        <div class="collapse" v-bind:id="ReturnClassNameId(item)">
                                                                            <div class="row">
                                                                                <div class="col-4" v-for="Tag in filterTagClass(item.tagClassId)">
                                                                                    <input type="checkbox" v-bind:id="ReturnNameId(Tag)" v-bind:value="Tag.tagId" v-model="TagChecked" />
                                                                                    <label v-bind:for="ReturnNameId(Tag)">{{Tag.tagName}}</label>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <hr />
                                                                    </template>
                                                                    <button class="astext overcard" type="button" data-bs-toggle="collapse" data-bs-target="#otherClass" aria-expanded="false" aria-controls="otherClass">
                                                                        其他
                                                                        <span class="badge bg-warning" v-if="selectedFilterTagClass(0,TagChecked) > 0">{{selectedFilterTagClass(0,TagChecked)}}</span>
                                                                    </button>
                                                                    <div class="collapse" id="otherClass">
                                                                        <div class="row">
                                                                            <div class="col-2" v-for="Tag in filterTagClass(0)">
                                                                                <input type="checkbox" v-bind:id="ReturnNameId(Tag)" v-bind:value="Tag.tagId" v-model="TagChecked" />
                                                                                <label v-bind:for="ReturnNameId(Tag)">{{Tag.tagName}}</label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>


                                                </p>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="card mb-3">
                                            <div class="card-body">
                                                <h5 class="card-title" style="text-align:center">自傳</h5>
                                                <p class="card-text">
                                                <textarea name="" id="" class="form-control overflow-auto" rows="8" v-model.lazy="Autobiography"></textarea>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 ">
                                    <span class="form-control text-center ">
                                        履歷狀態：
                                    <select v-model.lazy="releaseYN" class="btn btn-primary ms-4" disabled>
                                            <option :value="true">開放</option>
                                            <option :value="false">關閉</option>
                                        </select>
                                    </span>
                                </div>
                                <div class="form-group" style="text-align:right">
                                <button id="insert" type="submit" class="btn btn-success mx-3" data-bs-dismiss="modal" v-on:click="CreateNewResume">新增</button>
                                <button type="button" class="btn btn-secondary " data-bs-dismiss="modal" v-on:click="Createcancel">取消</button>
                                </div>

                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            

        @* 履歷內容Modal *@
        <div class="modal fade" v-for="ResumeD in Resume"
             :id="mergeID(ResumeD)"
             tabindex="-1"
             data-bs-backdrop="static"
             data-bs-keyboard="false"
             role="dialog"
             aria-labelledby="modalTitleId"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl"
                 role="document">
                <div class="modal-content">
                    <div class="card modal-body bg-warning">
                        @* 履歷編輯 *@
                        <template v-if="ResumeD.edit == true">
                            <div  class="card-body container-fluid" >
                            <div class="modal-header" style="background-color: #f7d179;">
                                <h5 class="modal-titl text-center" id="modal" style="width:95% ;">
                                    {{ResumeD.title}}
                                </h5>
                                <button type="button"
                                        class="btn-close"
                                        data-bs-dismiss="modal"
                                        aria-label="Close"
                                            style="width:5% ;" v-on:click="cancel(ResumeD)">
                                </button>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">個人資料</h5>
                                                <div>
                                                    <a href="#" class="mb-3" v-on:click.prevent="">
                                                        <div>
                                                            @* ResumeD.headshot.startsWith('data:') ? ResumeD.headshot : 'data:image/jpeg;base64,' + ResumeD.headshot：如果 ResumeD.headshot 以 data: 開頭，直接使用 ResumeD.headshot；否則，加上 'data:image/jpeg;base64,' 前綴來顯示 Base64 圖片。
                                                            : noImagePreview：如果 ResumeD.headshot 不存在，則顯示預設圖片 noImagePreview。 *@
                                                            <img class="rounded float-end mx-4 img-fluid" :src="ResumeD.headshot ? (ResumeD.headshot.startsWith('data:') ? ResumeD.headshot : 'data:image/jpeg;base64,' + ResumeD.headshot) : noimagepreview" style="width:100px;height:100px" title="待上傳" />
                                                        </div>

                                                    </a>
                                                    <input id="HeadshotEditFile" class="" style="" type="file" name="name" accept="image/*" v-on:change="previewImage($event, ResumeD)" />
                                                </div>
                                                
                                            <p class="card-text">
                                                    <div class="col">
                                                        <label class="mb-2" size="10">
                                                            姓名:{{ResumeD.name}}
                                                        </label>
                                                    </div>
                                                    <div>
                                                        <label for="" class="mb-2">性別 : {{Sexif(ResumeD.sex)}}</label>

                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">生日 : {{ResumeD.birthday}}</label>
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">電話 : {{ResumeD.phone}}</label>
                                                        <label for="" class="mb-2 mx-3">學歷 : {{ResumeD.degree}}</label>
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">郵件 : {{ResumeD.email}}</label>
                                                    </div>
                                                     <div class="col">
                                                        <label for="" class="mb-2">就業狀態 : {{ResumeD.employmentStatus}}</label>
                                                     </div>
                                                    <div>
                                                        <p class="card-text">
                                                            自我介紹：
                                                            <textarea name="" id="" class="form-control" rows="6" >{{ResumeD.intro}}</textarea>
                                                        </p>
                                                    </div>
                                                    
                                            </p>
                                                

                                            

                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">工作經驗</h5>
                                            <p class="card-text">
                                                    <textarea name="" id="" class="form-control" rows="12" v-model.lazy="ResumeD.workExperience"></textarea>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">求職條件</h5>
                                            <p class="card-text">

                                                <div class="col">
                                                        <label class="mb-2">上班時段: <input type="text" v-model.lazy="ResumeD.time"></label>
                                                </div>
                                                <div class="col">
                                                    <label class="">希望職缺:</label>
                                                <select style="width:30%" v-model="selectedtitleClassId">
                                                    <option value="" selected>-----請選擇-----</option>
                                                    <option v-for="item in titleClass" :value="item.titleClassId">{{item.titleclassName}}</option>
                                                </select>
                                                </div>
                                                <div class="col">
                                                        <label class="mb-2">希望上班地點: <input type="text" v-model.lazy="ResumeD.address"></label>
                                                </div>
                                                <div class="col">
                                                    <label for="" class="mb-2">證照
                                                            <input id="CertificationEditFile" type="file" accept="image/*" multiple/>
                                                        </label>
                                                </div>
                                                    <div>
                                                <p>
                                                    <label>
                                                        <button class="btn btn-outline-primary " type="button" data-bs-toggle="collapse" data-bs-target="#TagsCollapse" aria-expanded="false" aria-controls="TagsCollapse">能力標籤</button>
                                                        check: {{TagCheckedOpening}}<label><span class="badge bg-primary" v-for="item in TagCheckedOpening"></span></label>
                                                    </label>
                                                </p>
                                                <div class="collapse" id="TagsCollapse">
                                                    <div class="card card-body">
                                                        <template v-for="(item,index) in TagClasses">
                                                            <button class="astext overcard" type="button" data-bs-toggle="collapse" v-bind:data-bs-target="Returnhashtag(item)" aria-expanded="false" v-bind:aria-controls="item.tagClassName">{{item.tagClassName}}</button>
                                                            <div class="collapse" v-bind:id="item.tagClassName">
                                                                <div>
                                                                    <template class="px-2" v-for="Tag in filterTagClass(item.tagClassId)">
                                                                        <input type="checkbox" v-bind:id="changeTagNameTo(Tag.tagName)" v-bind:value="Tag.tagId" v-model="selectedtitleClassId" />
                                                                        <label v-bind:for="changeTagNameTo(Tag.tagName)">{{Tag.tagName}}</label>
                                                                    </template>
                                                                </div>
                                                            </div>
                                                            <hr />
                                                        </template>
                                                    </div>
                                                </div>
                                            </div>
                                            </p>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">自傳</h5>
                                            <p class="card-text">
                                                    <textarea name="" id="" class="form-control" rows="8" v-model.lazy="ResumeD.autobiography"></textarea>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 ">
                                    <span class="form-control text-center ">履歷狀態：
                                            <select v-model.lazy="ResumeD.releaseYN" class="btn btn-primary ms-4">
                                                <option :value="true">開放</option>
                                                <option :value="false">關閉</option>
                                        </select>
                                    </span>
                                </div>
                            </div>
                            <div class="" style="text-align:right">
                                <button id="update" type="submit" class="btn btn-success mx-3" v-on:click="editConfirm(ResumeD)">編輯完成</button>
                                    <button type="button" class="btn btn-secondary " v-on:click="cancel(ResumeD)">取消</button>

                            </div>
                            
                        </div>
                        </template>
                        @* 履歷純顯示 *@
                        <template v-else="ResumeD.edit == flase">
                            <div  class="card-body container-fluid" >
                            <div class="modal-header" style="background-color: #f7d179;">
                                <h5 class="modal-titl text-center" id="modal" style="width:95% ;" v-model="">
                                    {{ResumeD.title}}
                                </h5>
                                <button type="button"
                                        class="btn-close"
                                        data-bs-dismiss="modal"
                                        aria-label="Close"
                                        style="width:5% ;" v-on:click="TagCheckedResume=[]">
                                </button>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">個人資料</h5>
                                                <div class="mb-3"><img class="rounded float-end mx-4 img-fluid" :src="ResumeD.headshot ? 'data:image/jpeg;base64,' + ResumeD.headshot : noimagepreview" style="width:100px;height:100px" title="待上傳" /></div>
                                            <p class="card-text">
                                                <div class="col">
                                                        <label class="mb-2" size="10">姓名:{{ResumeD.name}} </label>
                                                       
                                                </div>
                                                <div>
                                                    <label for="" class="mb-2" >性別 : {{Sexif(ResumeD.sex)}}</label>
                                                </div>
                                                <div class="col">
                                                    <label for="" class="mb-2" >生日 : {{ResumeD.birthday}}</label>
                                                </div>
                                                <div class="col">
                                                    <label for="" class="mb-2">電話 : {{ResumeD.phone}}</label>
                                                    <label for="" class="mb-2 mx-3">學歷 : {{ResumeD.degree}}</label>
                                                </div>
                                                <div class="col">
                                                    <label for="" class="mb-2">郵件 : {{ResumeD.email}}</label>
                                                </div>
                                                <div class="col">
                                                        <label for="" class="mb-2">就業狀態 : {{ResumeD.employmentStatus}}</label>
                                                </div>
                                                <div class="card-body">
                                                        <h5 class="card-title" style="">自我介紹：</h5>
                                                        <p class="card-text form-control overflow-auto" style="height:200px">
                                                            {{ResumeD.intro}}
                                                        </p>
                                                </div>
                                            </p>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">工作經驗</h5>
                                            <p class="card-text form-control overflow-auto" style="height:250px">
                                                {{ResumeD.workExperience}}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">求職條件</h5>
                                            <p class="card-text">
                                                <div class="col">
                                                    <label class="mb-2">上班時段: {{ResumeD.time}}</label>
                                                </div>
                                                <div class="col">
                                                    <label class="">希望職缺:</label>

                                                </div>
                                                    <div class="col">
                                                        <label class="mb-2">希望上班地點: {{ResumeD.address}}</label>
                                                    </div>
                                                    <div class="col">
                                                        <label for="" class="mb-2">證照
                                                        </label>
                                                    </div>
                                                <div>
                                                    <p>
                                                        <label>
                                                            <button class="btn btn-outline-primary " type="button" data-bs-toggle="collapse" data-bs-target="#TagsCollapse" aria-expanded="false" aria-controls="TagsCollapse">能力標籤</button>
                                                            check: {{TagCheckedOpening}}<label><span class="badge bg-primary" v-for="item in TagCheckedOpening"></span></label>
                                                        </label>
                                                    </p>
                                                    <div class="collapse" id="TagsCollapse">
                                                        <div class="card card-body">
                                                            <template v-for="(item,index) in TagClasses">
                                                                <button class="astext overcard" type="button" data-bs-toggle="collapse" v-bind:data-bs-target="Returnhashtag(item)" aria-expanded="false" v-bind:aria-controls="item.tagClassName">{{item.tagClassName}}</button>
                                                                <div class="collapse" v-bind:id="item.tagClassName">
                                                                    <div>
                                                                        <template class="px-2" v-for="Tag in filterTagClass(item.tagClassId)">
                                                                            <input type="checkbox" v-bind:id="changeTagNameTo(Tag.tagName)" v-bind:value="Tag.tagId" v-model="TagCheckedOpening" />
                                                                            <label v-bind:for="changeTagNameTo(Tag.tagName)">{{Tag.tagName}}</label>
                                                                        </template>
                                                                    </div>
                                                                </div>
                                                                <hr />
                                                            </template>
                                                        </div>
                                                    </div>
                                                </div>
                                            </p>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h5 class="card-title" style="text-align:center">自傳</h5>
                                            <p class="card-text form-control overflow-auto" style="height:200px">
                                                {{ResumeD.autobiography}}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class=" col-md-3 ">
                                        <label class="form-control text-center" v-model.lazy="releaseYN" :value="ResumeD.releaseYN">履歷狀態： <span class="btn btn-primary ms-4">{{Resumeif(ResumeD.releaseYN)}}</span></label>
                                </div>
                            </div>
                            <div class="" style="text-align:right">
                                    <button type="button" class="btn btn-secondary " v-on:click="edit(ResumeD)">編輯</button>
                                
                            </div>
                            
                        </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>

        


        








        @* 分頁 *@
        <div>
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-center">
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Previous" v-on:click="setPage(currentPage-1)">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li v-for="item in totalPage" class="page-item" v-on:click="setPage(item)">
                        <a class="page-link" href="#">{{item}}</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Next" v-on:click="setPage(currentPage+1)">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>


@section Scripts
{
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        let VueApp = {
            data() {
                return {
                    pageStatus: 0,
                    perpage: 7, //一頁的資料數
                    currentPage: 1,
                    MessageStatus: 1,
                    resumevalue: "resumevalue",
                    Resume:[],
                    backupResume: {},
                    ResumeName:"",
                    releaseYN:true,
                    WorkExperience:"",
                    Autobiography:"",
                    hopeaddress:"",
                    timeR: "",
                    sexYN:false,
                    ResumeIntro:"",
                    noimagepreview: "/images/No_Image_Available.jpg",
                    originalHeadshot: null,
                    TagClasses: [],
                    Tags: [],
                    TagChecked: [],
                    TagCheckedOpening: [],

                    titleClass: [],
                    titleCategory:[],
                    TitleClassChecked: [],
                    TitleClassCheckedOpening:[],
                    selectedtitleClassId: '',
                };
            },
        
            computed: {
                totalPage() {
                    return Math.ceil(this.Resume.length / this.perpage)
                    //Math.ceil()取最小整數
                },
                pageStart() {
                    return (this.currentPage - 1) * this.perpage
                    //取得該頁第一個值的index
                },
                pageEnd() {
                    return this.currentPage * this.perpage
                    //取得該頁最後一個值的index
                },
                
                
            },
            methods: {
                setPage(page) {
                    if (page <= 0 || page > this.totalPage) {
                        return
                    }
                    this.currentPage = page
                },
                //判斷男女
                Sexif(ResumeD) {
                    return ResumeD == true ? "男":"女";   
                },
                //判斷履歷開放狀態
                Resumeif(ResumeD){
                    return ResumeD == true ? "開放":"關閉";   
                },
                edit:function(ResumeD) {
                    let _this = this;
                    _this.backupResume = {
                        WorkExperience: ResumeD.workExperience,
                        hopeaddress: ResumeD.address,
                        ResumeName: ResumeD.title,
                        Autobiography: ResumeD.autobiography,
                        timeR: ResumeD.time,
                        releaseYN:ResumeD.releaseYN,
                        ResumeIntro: ResumeD.intro,
                        Headshot: ResumeD.headshot,
                    };
                    ResumeD.edit = true;
                },
                Createcancel(){
                    window.location.reload()
                },
                //取消新增or編輯履歷
                cancel(ResumeD) {
                    let _this = this
                    for (let n = 0; n < _this.Resume.length; n++) {
                        let ResumeD = _this.Resume[n];

                            ResumeD.workExperience = _this.backupResume.WorkExperience;
                            ResumeD.address = _this.backupResume.hopeaddress;
                            ResumeD.title = _this.backupResume.ResumeName;
                            ResumeD.autobiography = _this.backupResume.Autobiography;
                            ResumeD.time = _this.backupResume.timeR;
                            ResumeD.releaseYN = _this.backupResume.releaseYN;
                            ResumeD.intro = _this.backupResume.ResumeIntro;
                            ResumeD.headshot = _this.backupResume.Headshot;
                        
                    }
                    ResumeD.edit = false
                    
                },
                mergeID(ResumeD) {
                    let str = ResumeD.name.replace(/\s/g, "");
                    let num = ResumeD.resumeid;
                    strID = str + num;
                    return strID;
                },

                changeTagNameTo: function (TagName) {
                    let _this = this;
                    return `${TagName}BindID`;
                },
                changeTitleClassNameTo: function (TitleClassName) {
                    let _this = this;
                    return `${TitleClassName}BindID`;
                },
                filterTagClass: function (ClassID) {
                    let _this = this;
                    return _this.Tags.filter(function (item) {
                        return item.tagClassId == ClassID;
                    });
                },
                filterTitleCategory: function (CategoryID) {
                    let _this = this;
                    return _this.titleClass.filter(function (item) {
                        return item.titleCategoryId == CategoryID;
                    });
                },
                selectedFilterTagClass: function (ClassId, TagChecked) {
                    let _this = this;
                    let counter = 0;
                    for (let i = 0; i < TagChecked.length; i++) {
                        if (this.filterTagClass(ClassId).filter(function (item) {
                            return item.tagId == TagChecked[i];
                        }).length > 0) { counter++; }
                    }
                    return counter;
                },
                selectedFilterTitleCategory: function (titleCategoryId, TitleClassChecked) {
                    let _this = this;
                    let counter = 0;
                    for (let i = 0; i < TitleClassChecked.length; i++) {
                        if (this.filterTitleCategory(titleCategoryId).filter(function (item) {
                            return item.titleClassId == TitleClassChecked[i];
                        }).length > 0) { counter++; }
                    }
                    return counter;
                },
                ReturnNameId: function (item) {
                    let NameId = `NameId${item.tagName}${item.tagId}`;
                    return NameId.replace(" ", "");
                },
                ReturnClassNameId: function (item) {
                    let ClassNameId = `ClassNameId${item.tagClassName}${item.tagClassId}`;
                    return ClassNameId.replace(" ", "");
                },
                Returnhashtag: function (item) {
                    return `#${item}`;
                },
                ReturnCategoryNameId: function (item) {
                    let CategoryNameId = `CategoryNameId${item.titleCategoryName}${item.titleCategoryId}`;
                    return CategoryNameId.replace(" ", "");
                },
                getTitleClassName(titleClassId) {
                    if (!Array.isArray(titleClassId)) return '未指定';
                    return titleClassId
                        .map(id => {
                            let titleClassItem = this.titleClass.find(item => item.titleClassId === id);
                            return titleClassItem ? titleClassItem.titleClassName : '未指定';
                        })
                        .join(', '); // 用逗號分隔
                },

                //履歷編輯與顯示畫面圖片預覽
                previewImage: function (event, ResumeD,btn) {
                    let _this = this;
                    let input = event.target.files[0];
                    var imageType = "image.*";
                    if (input.type.match(imageType)) {

                        let reader = new FileReader();
                        reader.onload = (e) => {
                            ResumeD.headshot = e.target.result;
                        }

                        reader.readAsDataURL(input);

                    } else {
                        alert("檔案格式不支援上傳");
                        btn.prop("disabled", true);
                        
                    }
                },
                //新增履歷的圖片顯示
                CreatepreviewImage: function (event) {
                    var input = event.target;
                    if (input.files) {
                        var reader = new FileReader();
                        reader.onload = (e) => {
                            this.noimagepreview = e.target.result;
                        }
                        this.image = input.files[0];
                        reader.readAsDataURL(input.files[0]);
                    }
                },
                
                ResumeInformation: function () {
                    //履歷全部資料
                    fetch("/Candidates/Resume/ResumeResult", {
                        method:"GET",
                    }).then(response=>{
                        return response.json();
                    }).then(data=> {
                        return this.Resume = data
                    }).catch(err=>{
                        alert(JSON.stringify(err))
                    });

                    //職業類別名稱和ID
                    fetch("/Candidates/Resume/TitleCategoryJson", {
                        method:"GET",
                    }).then(response=>{
                        return response.json();
                    }).then(data=> {
                        return this.titleCategory = data
                    }).catch(err=>{
                        alert(JSON.stringify(err))
                    });
                    //職業類型
                    fetch("/Candidates/Resume/TitleClassJson", {
                        method:"GET",
                    }).then(response=>{
                        return response.json();
                    }).then(data=> {
                        return this.titleClass = data
                    }).catch(err=>{
                        alert(JSON.stringify(err))
                    });

                    fetch("/Candidates/Resume/TagJson", {
                        method:"GET",
                    }).then(response=>{
                        return response.json();
                    }).then(data=> {
                        return this.Tags = data
                    }).catch(err=>{
                        alert(JSON.stringify(err))
                    });

                    fetch("/Candidates/Resume/TagClassJson", {
                        method:"GET",
                    }).then(response=>{
                        return response.json();
                    }).then(data=> {
                        return this.TagClasses = data
                    }).catch(err=>{
                        alert(JSON.stringify(err))
                    });
                },
                //新增履歷
                CreateNewResume: function () {
                    let _this = this;
                    let candidateid = 1;
                    var form = new FormData();
                    form.append("CandidateId",candidateid);
                    form.append("Address", _this.hopeaddress);
                    form.append("Title", _this.ResumeName);
                    form.append("Autobiography", _this.Autobiography);
                    form.append("WorkExperience", _this.WorkExperience);
                    form.append("Time", _this.timeR);
                    form.append("ReleaseYN", _this.releaseYN);
                    form.append("Intro", _this.ResumeIntro);
                    form.append("HeadshotImageFile", document.querySelector('#HeadshotinsertFile').files[0]);
                    form.append("CertificationImageFile", document.querySelector('#CertificationInsertFile').files[0]);
                    form.append("CertificationImageFile", document.querySelector('#CertificationInsertFile').files[1]);
                    form.append("CertificationImageFile", document.querySelector('#CertificationInsertFile').files[2]);
                    form.append("CertificationImageFile", document.querySelector('#CertificationInsertFile').files[3]);
                    fetch("https://localhost:7169/Candidates/Resume/CreateReasumes", {
                        method: "POST",
                        body: form
                    }).then(response => {
                        return response.json()
                    }).then(data => {
                        if (data.success) {
                            alert("新增履歷成功")
                            window.location.reload();
                        } else {
                            alert("新增履歷失敗")
                            window.location.reload();
                        }
                    }).catch(err => {
                        console.log(err)
                    })
                },
                
                //編輯完成再確認，並執行editResumD()
                editConfirm: function(ResumeD){
                    const Confirmed = confirm("確定要編輯嗎?");
                    if(Confirmed){
                        this.editResumD(ResumeD);
                    }else{
                        alert("已取消編輯");
                    };
                },
                //編輯履歷並修改資料庫資料
                editResumD: function (ResumeD) {
                    var _this = this
                    var form = new FormData();
                    form.append("ResumeId", ResumeD.resumeid);
                    form.append("CandidateId", ResumeD.candidateId);
                    form.append("Address", ResumeD.address);
                    form.append("Title", ResumeD.title);
                    form.append("Autobiography", ResumeD.autobiography);
                    form.append("WorkExperience", ResumeD.workExperience);
                    form.append("Time", ResumeD.time);
                    form.append("ReleaseYN", ResumeD.releaseYN);
                    form.append("Intro", ResumeD.intro);
                    form.append("HeadshotImageFile", document.querySelector('#HeadshotEditFile').files[0]);
                    // form.append("__RequestVerificationToken", $(AntiForgeryToken).val());
                    fetch("https://localhost:7169/Candidates/Resume/EditResume", {
                        method: "POST",
                        "content-type": "multipart/form-data",
                        body:form,
                    }).then(response => {
                        return response.json()
                    }).then(data => {
                        if (data.success) {
                            alert("編輯履歷成功")
                            window.location.reload();
                        } else {
                            alert("編輯履歷失敗")
                        }
                    }).catch(err => {
                        alert(err)
                    });
                    // this.originalHeadshot = ResumeD.headshot;
                    // ResumeD.edit = false;
                },
                //刪除履歷
                deleteResume: function (item) {
                    let _this = this
                    var confirmdel = confirm("確定要刪除?");
                    var request = {};
                    request.resumeid = item.resumeid;
                    if (confirmdel == true) {
                        fetch("https://localhost:7169/Candidates/Resume/DelResume", {
                            method: "DELETE",
                            headers: {
                                "content-type": "application/json",  //告訴伺服器我們發送的是 JSON 格式的數據。
                            },
                            body: JSON.stringify(request)
                        }).then(response => {
                            return response.json();
                        }).then(data=>{
                            if (data.success) {
                                alert("刪除履歷成功")
                                window.location.reload();
                            } else {
                                alert("刪除履歷失敗")
                                window.location.reload();

                            }
                            // alert(data.message);
                        }).catch(err => {
                            alert(err)
                        })
                        
                    }else{
                        alert("已取消操作")
                    }
                }
            },

            watch:{
            },
            mounted:function(){
                this.ResumeInformation();
            }
        };
        let app = Vue.createApp(VueApp).mount("#ResumeApp");
    </script>

}