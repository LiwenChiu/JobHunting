@model IEnumerable<CompanyOrdersViewModel>

@{
    ViewData["Title"] = "訂單紀錄";
}

@section Styles
{
    <style>

    </style>
}

<div id="CompanyOrdersVue">
    <h3 class="text-center pt-2">訂單紀錄</h3>

    <div class="row py-2 px-1">
       @*  <div class="col-md-10">
            <select class="" style="width:17%" id="OrderOpTitle2" v-model="orderSelA">
                <option :value="idx" v-for="items,idx in OrderDetail">{{items.Detail}}</option>
            </select>
            <select class="" style=" width:20%" v-model="orderSelB">
                <option value=0 v-if="orderSelA==0" v-for="item in CompanyOrders">{{item.companyName}}</option>
                <option value=1 v-else-if="orderSelA==1" v-for="item in CompanyOrders">{{item.title}}</option>
                <option value=2 v-else-if="orderSelA==2" v-for="item in CompanyOrders">{{item.orderDate}}</option>
                <option value=3 v-else-if="orderSelA==3" v-for="item in CompanyOrders">{{item.duration}}</option>
                <option value=4 v-else v-for="item in CompanyOrders">{{item.status}}</option>
            </select>
        </div> *@
        <div class="container-fluid row py-2">
            <label class="col-md-2 text-end" for="filterCompanyOrders">關鍵字搜尋:</label>
            <input type="text" id="filterCompanyOrders" class="col-md-8" placeholder="請輸入篩選關鍵字" v-model.trim="filter" v-on:keyup="filterCompanyOrders" />
        </div>
    </div>
    

    <div class="container tableOutside ">
        <table class="table table-striped text-center mt-5" id="ChangePage" style="">
            <thead class="table-warning">
                <tr>
                    <th scope="col">訂單ID</th>
                    <th scope="col">公司名稱</th>
                    <th scope="col">方案名稱</th>
                    <th scope="col">訂購日期</th>
                    <th scope="col">到期日</th>
                    <th scope="col">付款狀態</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in CompanyOrders">
                    <th scope="row">{{item.OrderID}}</th>
                    <td>{{item.companyName}}</td>
                    <td>{{item.title}}</td>
                    <td>{{item.orderDate}}</td>
                    <td>{{item.duration}}</td>
                    <td><button class="btn btn-light btn-sm">{{item.status}}</button></td>
                </tr>
            </tbody>
        </table>
        <nav aria-label="Page navigation example">
            <ul class="pagination ">
                <li class="page-item me-auto"><a class="page-link" href="#">上一頁</a></li>
                <li class="page-item"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item"><a class="page-link" href="#">4</a></li>
                <li class="page-item"><a class="page-link" href="#">5</a></li>
                <li class="page-item ms-auto"><a class="page-link" href="#">下一頁</a></li>
            </ul>
        </nav>
    </div>
</div>

@section Scripts
{
    <script>
        let VueAppPricingOrderHistory = {
            data(){
                return {
                    baseAddress: "https://localhost:7169",
                    filter: "",
                    isShow:false,
                    orderSelA: "",
                    orderSelB: "",
                    CompanyOrders: [],
                    OrderDetail:
                    [
                        {Detail: "公司名稱" },
                        {Detail: "方案名稱" },
                        {Detail: "訂購日期" },
                        {Detail: "方案天數" },
                        {Detail: "付款狀態" },
                    ],
                };
            },
            computed:{
                orderSelAc: function (selval) {
                    this.orderSelB = selval
                },
            },
            methods:{
                filterCompanyOrders: function () {
                    let _this = this;
                    let request = {};
                    request.OrderID = isNaN(Number(_this.filter)) ? -1 : Number(_this.filter);
                    request.CompanyName = request.GUINumber = request.Title = request.Intro = _this.filter;
                    request.CompanyID = request.PlanID = request.Price = request.OrderDate = request.Duration = request.Status = null;
                    axios.post(`${_this.baseAddress}/Admins/CompanyOrders/Filter`, request)
                        .then(
                            response => {
                                _this.CompanyOrders = response.data;
                                for (let i = 0; i < _this.CompanyOrders.length; i++) {
                                    _this.CompanyOrders[i].Edit = false;
                                }
                            })
                        .catch(err => {
                            alert(err)
                        });
                },
                // payStatus: function (status) {
                //     if (status) {
                //         return "已付款";
                //     }
                //     else {
                //         return "尚未付款";
                //     }
                // }
            },
            watched:{

            },
            mounted: function(){
                let _this = this;
                _this.filterCompanyOrders();
            },
        };
        let app = Vue.createApp(VueAppPricingOrderHistory).mount("#CompanyOrdersVue");
    </script>
}
